<h1 class="centered-title user-name">
  <%= @user ? "#{@user.name} さん" : 'ユーザーが見つかりません' %>
</h1>

<% if @user %>
  <div class="user-info-container">
    <div class="user-info-block">
      <p class="user-info large-text center-text">
        <strong>生年月日:</strong> <%= @user.birthday&.strftime("%Y年%-m月%-d日") %>
      </p>
      <p class="user-info large-text center-text">
        <% if @user.birthday %>
          <% age, months = @user.age_with_months %>
          <strong>年齢:</strong> <%= age %> 歳 <%= months %> ヶ月
        <% else %>
          生年月日がありません。
        <% end %>
      </p>
    </div>
    <div class="icon-container">
      <%= link_to new_condition_path(user_id: @user.id), class: 'icon-link', title: '新しい体調記録を追加' do %>
        <%= image_tag 'newennpiru.png', class: 'icon-small' %>
      <% end %>
    </div>
  </div>

  <h2 class="centered-title record-title"><%= @user.name %>さんの体調記録</h2>

  <% if @conditions.present? %>
    <table class="record-table">
      <thead>
        <tr>
          <th>記録日時</th>
          <th>体温</th>
          <th>食欲</th>
          <th>水分</th>
          <th>嘔吐</th>
          <th>メモ</th>
          <th>画像</th>
          <th>操作</th>
        </tr>
      </thead>
      <tbody>
        <% @conditions.each do |condition| %>
          <tr>
            <td><%= condition.input_day.strftime("%Y年%-m月%-d日 %H:%M") %></td>
            <td><%= condition.temperature %>°C</td>
            <td><%= condition.eat || '記録なし' %></td>
            <td><%= condition.moisture || '記録なし' %></td>
            <td><%= condition.puke || '記録なし' %></td>
            <td><%= condition.memo || '記録なし' %></td>
            <td>
              <% if condition.images.attached? %>
                <% condition.images.each do |image| %>
                  <%= image_tag image.variant(resize_to_limit: [50, 50]), class: 'record-image-small' %>
                <% end %>
              <% else %>
                画像なし
              <% end %>
            </td>
            <td class="action-buttons">
              <%= link_to '編集', edit_condition_path(condition), class: 'btn btn-primary btn-sm' %>
              <%= button_to '削除', condition_path(condition), method: :delete, data: { confirm: '本当に削除しますか？' }, class: 'btn btn-danger btn-sm' %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <p>体調記録がありません。</p>
  <% end %>
<% end %>